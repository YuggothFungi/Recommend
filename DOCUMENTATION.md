# Техническая документация

## Содержание
1. [Компоненты системы](#компоненты-системы)
2. [База данных](#база-данных)
3. [API](#api)
4. [Конфигурация](#конфигурация)

## Компоненты системы

### Обработка текста (text_processor.py)

Класс TextProcessor описывает объект "Обработчик текста", реализует действия:
- "нормализация" для "приведения текста к нормализованному виду"
- "лемматизация" для "приведения слов к нормальной форме"
- "обработка составных терминов" для "сохранения тематических словосочетаний"

### Векторизация (vectorizer.py)

Класс Vectorizer описывает объект "Векторизатор", реализует действия:
- "векторизация" для "преобразования текстов в векторы"
- "сохранение" для "сохранения векторов в базе данных"
- "загрузка" для "загрузки векторов из базы данных"

Поддерживаемые методы векторизации:
1. TF-IDF
   - Векторизация на основе частоты терминов
   - Учет важности терминов в корпусе
   - Нормализация векторов

2. ruBERT
   - Векторизация на основе языковой модели
   - Учет контекста и семантики
   - Нормализация векторов

### Конфигурация векторизации (vectorization_config.py)

Класс VectorizationConfig описывает объект "Конфигурация векторизации", реализует действия:
- "загрузка" для "загрузки конфигурации из БД"
- "сохранение" для "сохранения конфигурации в БД"
- "управление весами" для "настройки весов различных компонентов"

### Веса текстов (vectorization_text_weights.py)

Класс VectorizationTextWeights описывает объект "Веса текстов", реализует действия:
- "получение текста" для "извлечения текста с учетом весов"
- "нормализация" для "приведения текста к нормализованному виду"
- "объединение" для "создания единого текста из компонентов"

## База данных

### Схема базы данных

Основные таблицы:
1. `disciplines` - дисциплины
2. `semesters` - семестры
3. `sections` - разделы
4. `lecture_topics` - темы лекций
5. `practical_topics` - темы практик
6. `self_control_questions` - вопросы для самоконтроля
7. `competencies` - компетенции
8. `specialties` - специальности
9. `labor_functions` - трудовые функции
10. `vectorization_configurations` - конфигурации векторизации
11. `vectorization_weights` - веса для векторизации
12. `vectorization_results` - результаты векторизации
13. `similarity_results` - результаты расчета сходства

### Связи между таблицами

1. Дисциплины и семестры (многие-ко-многим)
2. Дисциплины и разделы (один-ко-многим)
3. Разделы и темы (один-ко-многим)
4. Дисциплины и компетенции (многие-ко-многим)
5. Специальности и трудовые функции (многие-ко-многим)

### Индексы и оптимизация

1. Индексы для поиска
   - По названиям дисциплин
   - По кодам компетенций
   - По трудовым функциям

2. Оптимизация запросов
   - Кэширование результатов
   - Партиционирование данных
   - Оптимизация JOIN-ов

## API

### Эндпоинты

1. Конфигурации
   - GET /api/configurations - список конфигураций
   - GET /api/configurations/{id} - детали конфигурации
   - POST /api/configurations - создание конфигурации
   - PUT /api/configurations/{id} - обновление конфигурации
   - DELETE /api/configurations/{id} - удаление конфигурации

2. Векторизация
   - POST /api/vectorize - векторизация текстов
   - GET /api/vectorize/{id} - статус векторизации
   - GET /api/vectorize/{id}/results - результаты векторизации

3. Сходство
   - POST /api/similarity - расчет сходства
   - GET /api/similarity/{id} - статус расчета
   - GET /api/similarity/{id}/results - результаты расчета

### Форматы данных

1. Запросы
   ```json
   {
     "text": "string",
     "config_id": "integer",
     "vectorizer": "string"
   }
   ```

2. Ответы
   ```json
   {
     "status": "string",
     "data": "object",
     "error": "string"
   }
   ```

## Конфигурация

### Настройка БД
- Путь к файлу БД
- Настройки подключения
- Оптимизация запросов

### Настройка API
- Порт и хост
- Аутентификация
- Логирование

### Настройка безопасности
- Защита от SQL-инъекций
- Валидация входных данных
- Ограничение доступа

### SelectionController

- **selectTopic(topic)** — выбирает тему, сбрасывает выбранную функцию, загружает список функций и объект similarities через SimilarityModel, передаёт их во FunctionsView.render для отображения и подсветки топ-3 функций по сходству.
