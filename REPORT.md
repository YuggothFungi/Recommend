# REPORT.md

## Описание и назначение

Данный проект — рекомендательная система для сопоставления учебных программ и профессиональных стандартов. Система автоматически выявляет взаимосвязи между темами учебных дисциплин и требованиями профессиональных стандартов на основе семантического анализа текстовых данных и выдает рекомендации по улучшению программ.

## Проектирование структуры данных

На первом этапе была разработана структура исходных JSON-файлов, чтобы обеспечить единообразие и полноту данных для последующей обработки. Были определены следующие форматы:
- **abilities.json** — содержит перечень компетенций с кодами, категориями и описаниями.
- **prof_std.json** — включает трудовые функции, их идентификаторы, уровни квалификации и связанные компоненты.
- **database.json** — описывает учебные дисциплины, их темы, описание, часы, а также связи с компетенциями.

Эта структура позволила унифицировать процесс загрузки и обработки данных, а также обеспечить расширяемость системы.

## Структура проекта

```
.
├── src/                # Обработка данных, векторизация, работа с базой данных, проверки
├── frontend/           # Пользовательский интерфейс (серверная часть на Flask, HTML, JavaScript, таблицы стилей)
├── database/           # База данных SQLite
├── tests/              # Модули тестирования
├── input/, data/       # Входные и промежуточные данные
├── main.py             # Точка входа
├── requirements.txt    # Зависимости
├── OVERVIEW.md         # Описание целей и задач
├── DOCUMENTATION.md    # Описание классов, функций, базы данных
├── TASKS.md            # Статус задач
└── README.md           # Краткое описание и инструкции
```

## Основные функции и компоненты

- Серверная часть реализована на Flask и предоставляет интерфейс обмена данными для получения дисциплин, тем, трудовых функций, результатов сходства и рекомендаций. Пользовательский интерфейс получает все данные через этот интерфейс обмена данными.
- Пользовательский интерфейс — двухпанельный: две таблицы (темы и трудовые функции), выпадающий список дисциплин, слайдер порога сходства, панель рекомендаций. Вся работа реализована на JavaScript, стилизация — с помощью таблиц стилей.
- Векторизация реализована с помощью как разработанных под конкретный набор данных инструментов (TF-IDF, токенизатор), так и предобученных векторных представлений (ruBERT). Векторы сохраняются в базе данных и используются для расчёта косинусного сходства.
- Тесты покрывают загрузку данных, корректность векторов, расчёт сходства, нормализацию текстов и обеспечивают стабильность работы приложения.

## Подготовка данных и векторизация

1. **Загрузка и подготовка данных**
   - Исходные данные (компетенции, трудовые функции, темы) подготавливаются вручную и хранятся в JSON-файлах по согласованной структуре.
   - Данные нормализуются: приведение к нижнему регистру, удаление специальных символов, стоп-слов, лемматизация (с использованием pymorphy2 и nltk).

2. **Векторизация**
   - **TF-IDF**: реализован токенизатор, разработанный под конкретный набор данных, с учётом морфологии, используется scikit-learn для построения векторов.
   - **ruBERT**: используются предобученные векторные представления (модель sbert_large_nlu_ru), что позволяет учитывать глубокие семантические связи.
   - Векторы сохраняются в базе данных, используются для расчёта косинусного сходства между темами и трудовыми функциями.

3. **Расчёт сходства**
   - Косинусное сходство между векторами тем и трудовых функций.
   - Результаты сохраняются в таблице topic_labor_function.

## Организация компонентов

- **src/**: обработка данных, загрузка, нормализация, векторизация, работа с базой данных, проверки.
- **frontend/**: серверная часть на Flask, HTML-шаблоны, JavaScript (принцип работы интерфейса, сортировка, подсветка), таблицы стилей (стилизация, индикация).
- **tests/**: тесты для проверки данных, векторов, текстов, базы данных.

## Принцип работы пользовательского интерфейса и интерактивных элементов

- Пользователь выбирает дисциплину — загружаются темы и трудовые функции.
- При выборе темы: трудовые функции сортируются по similarity, подсвечивается только выбранная тема.
- При выборе трудовой функции: темы сортируются по similarity, подсвечивается только выбранная функция.
- Строки с similarity <0.1 или его отсутствием подсвечиваются бледно-розовым.
- Если появляется рекомендация "Тема не обеспечивает трудовые функции" — все строки подсвечиваются бледно-розовым, сама рекомендация выделяется.
- Все обновления происходят асинхронно через интерфейс обмена данными.

## Тестирование и обеспечение стабильности

Тесты играют ключевую роль в поддержании стабильности и надёжности приложения:
- Проверка загрузки и корректности данных: позволяет выявить ошибки на этапе импорта и обработки исходных файлов.
- Проверка корректности векторов и их размерности: гарантирует, что векторизация прошла успешно и данные пригодны для дальнейших вычислений.
- Проверка расчёта сходства: позволяет убедиться, что алгоритмы сопоставления работают корректно и дают ожидаемые результаты.
- Проверка нормализации текстов: обеспечивает единообразие текстовых данных, что критично для качества векторизации и поиска сходства.
- Регулярный запуск тестов позволяет быстро выявлять и устранять ошибки, связанные с изменениями в коде или структуре данных, и поддерживать высокое качество продукта.

## Пользовательские сценарии

### 1. Отбор тем по выбранной трудовой функции
- Пользователь выбирает трудовую функцию в правой таблице.
- В левой таблице отображаются темы, отсортированные по степени близости (similarity) к выбранной функции.
- Строки с низким similarity (<0.1) или его отсутствием подсвечиваются бледно-розовым.
- Подсвечивается только выбранная трудовая функция.
- Если ни одна тема не обеспечивает трудовую функцию (similarity всех тем ниже порога), появляется рекомендация и все строки подсвечиваются бледно-розовым.

### 2. Отбор функций по выбранной теме
- Пользователь выбирает тему в левой таблице.
- В правой таблице отображаются трудовые функции, отсортированные по степени близости (similarity) к выбранной теме.
- Строки с низким similarity (<0.1) или его отсутствием подсвечиваются бледно-розовым.
- Подсвечивается только выбранная тема.
- Если ни одна трудовая функция не релевантна теме (similarity всех функций ниже порога), появляется рекомендация и все строки подсвечиваются бледно-розовым.

## Условия для отображения рекомендаций
- Если для выбранной темы или трудовой функции не найдено релевантных соответствий (similarity всех элементов ниже порога), появляется рекомендация "Тема не обеспечивает трудовые функции" или аналогичная.
- В этом случае все строки соответствующей таблицы подсвечиваются бледно-розовым, а сама рекомендация выделяется.

---

Документ подготовлен на основе анализа исходного кода, документации и реализованного функционала проекта.